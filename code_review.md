### Code Review — pgclone (Go rewrite)

#### Итоговая оценка
Переписанная на Go утилита демонстрирует хорошую архитектуру и читаемый код, но пока не достигает функционального паритета с Bash-версией и Acceptance Criteria из `TODO.md`. Для merge требуются доработки.

---

#### Основные замечания
1. **Design**
   - Не реализовано `--drop-existing` (очистка `ReplicaPGData`, `ReplicaWALDir`).
   - Нет проверки свободного места (аналог `check_space`).
   - Не поддерживается отдельный `--replica-waldir` (symlink `pg_wal`).
   - Флаг `--slot` реализован частично: слот не создаётся (`--create-slot`), дроп — по потенциально пустому имени.
   - Отсутствует удаление устаревших `backup_label`, `tablespace_map` при перезапуске.
2. **Correctness**
   - Не отслеживается преждевременный выход `pg_receivewal` — пайплайн может продолжаться с неверными данными.
   - Отсутствует валидация целостности `pg_control` после копирования.
   - Возможен race при переименовании последнего `*.partial` WAL-сегмента.
   - SSH-сессия может зависнуть при отмене контекста (нет тайм-аута на `session.Wait`).
3. **Style & Docs**
   - Смешанное использование `slog` и `fmt.Println` нарушает единый формат логов.
   - Русскоязычные комментарии в кодовой базе — придерживаемся английского.
   - Public-API пакетов без GoDoc-комментариев.
4. **Tests**
   - Отсутствуют тесты для критически важных компонентов (`clone.Orchestrator`, `wal.Receiver`, `ssh.Client`).
   - Текущее покрытие < 90 % (оценка).

---

#### Задачи разработчику
- [] **Реализовать `--drop-existing`** — удалять `ReplicaPGData` и `ReplicaWALDir` до старта.
- [] **Проверка места на диске** — вызвать `disk.EnsureSpace` до копирования.
- [] **Поддержка `--replica-waldir`** — создавать symlink `pg_wal → <replica-waldir>`.
- [] **Replication slot**:
  - создавать временный слот `pg_receivewal --create-slot --if-not-exists` при `--slot`;
  - сохранять имя в `Config.SlotName`;
  - корректно дропать слот в `Receiver.Stop`.
- [] **Удалять старые label-файлы** (`backup_label`, `tablespace_map`) перед новой сессией.
- [] **Отслеживать выход `pg_receivewal`** — останавливать пайплайн при ошибке процесса.
- [] **Валидация `pg_control`** — сравнить размер/CRC через `pg_controldata`.
- [] **Безопасное переименование *.partial** — убедиться в завершённой записи.
- [] **Корректная отмена SSH-сессий** — тайм-аут + сигнал `SIGKILL`.
- [] **Единый логгер** — заменить `fmt` на `slog`, добавить уровни.
- [ ] **Code style** — убрать русские комментарии, добавить GoDoc.
- [ ] **Тесты** — покрыть orchestrator happy-path, сбой `pg_receivewal`, мок `ssh.Client`; обеспечить ≥ 90 % coverage.

---

#### Критерии приёмки после исправлений
1. `go test ./...` и `golangci-lint run` — без ошибок.
2. Statement coverage ≥ 90 %.
3. Реплика создаётся и подключается к primary в тестовом окружении.
4. README обновлено, все флаги задокументированы и проверены. 